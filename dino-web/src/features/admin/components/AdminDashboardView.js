import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useState, useMemo } from "react";
import { formatCredits } from "../../../utils/format";
function getRelativeTime(timestamp) {
    const seconds = Math.floor((Date.now() - timestamp) / 1000);
    if (seconds < 5)
        return "ahora mismo";
    if (seconds < 60)
        return `hace ${seconds}s`;
    const minutes = Math.floor(seconds / 60);
    if (minutes < 60)
        return `hace ${minutes}m`;
    return `hace ${Math.floor(minutes / 60)}h`;
}
export function AdminDashboardView({ stats, activity, isLoading, timeRange, onTimeRangeChange, dataUpdatedAt, }) {
    const [, setTick] = useState(0);
    // Update relative time every 10 seconds
    useMemo(() => {
        const interval = setInterval(() => setTick((t) => t + 1), 10000);
        return () => clearInterval(interval);
    }, []);
    return (_jsxs(_Fragment, { children: [_jsxs("section", { className: "admin-chipbar", "aria-label": "Filtros temporales", children: [_jsx("button", { type: "button", className: `admin-chip ${timeRange === "24h" ? "admin-chip--active" : ""}`, onClick: () => onTimeRangeChange("24h"), children: "\u00DAltimas 24h" }), _jsx("button", { type: "button", className: `admin-chip ${timeRange === "7d" ? "admin-chip--active" : ""}`, onClick: () => onTimeRangeChange("7d"), children: "\u00DAltimos 7 d\u00EDas" }), _jsx("button", { type: "button", className: `admin-chip ${timeRange === "30d" ? "admin-chip--active" : ""}`, onClick: () => onTimeRangeChange("30d"), children: "\u00DAltimos 30 d\u00EDas" }), dataUpdatedAt && (_jsxs("span", { className: "admin-chip admin-chip--info", children: [_jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", style: { fontSize: 16 }, children: "schedule" }), "Actualizado ", getRelativeTime(dataUpdatedAt)] }))] }), _jsxs("section", { className: "admin-metrics", children: [_jsxs("article", { className: "admin-card admin-card--metric", children: [_jsxs("header", { children: [_jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", children: "group" }), _jsx("p", { children: "Usuarios totales" })] }), isLoading ? (_jsx("div", { className: "admin-skeleton admin-skeleton--number" })) : (_jsx("strong", { children: stats?.total_users?.toLocaleString() ?? 0 })), _jsx("span", { className: "admin-metric__trend admin-metric__trend--neutral", children: "Total" })] }), _jsxs("article", { className: "admin-card admin-card--metric", children: [_jsxs("header", { children: [_jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", children: "casino" }), _jsx("p", { children: "Partidas activas" })] }), isLoading ? (_jsx("div", { className: "admin-skeleton admin-skeleton--number" })) : (_jsx("strong", { children: stats?.active_games ?? 0 })), _jsx("span", { className: "admin-metric__trend admin-metric__trend--neutral", children: "En vivo" })] }), _jsxs("article", { className: "admin-card admin-card--metric", children: [_jsxs("header", { children: [_jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", children: "payments" }), _jsx("p", { children: "Ingresos totales" })] }), isLoading ? (_jsx("div", { className: "admin-skeleton admin-skeleton--number" })) : (_jsx("strong", { children: formatCredits(stats?.total_revenue ?? 0) })), _jsx("span", { className: "admin-metric__trend admin-metric__trend--neutral", children: "Dep\u00F3sitos" })] }), _jsxs("article", { className: "admin-card admin-card--metric", children: [_jsxs("header", { children: [_jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", children: "account_balance_wallet" }), _jsx("p", { children: "Movimientos hoy" })] }), isLoading ? (_jsx("div", { className: "admin-skeleton admin-skeleton--number" })) : (_jsx("strong", { children: stats?.today_transactions ?? 0 })), _jsx("span", { className: "admin-metric__trend admin-metric__trend--neutral", children: "Resumen" })] })] }), _jsxs("section", { className: "admin-grid", children: [_jsxs("article", { className: "admin-card admin-card--chart", children: [_jsxs("header", { children: [_jsx("p", { className: "admin-card__title", children: "Resumen de plataforma" }), _jsxs("div", { className: "admin-card__summary", children: [_jsx("strong", { children: formatCredits(stats?.total_pot ?? 0) }), _jsx("span", { className: "admin-metric__trend admin-metric__trend--neutral", children: "Pozo total" })] })] }), _jsx("p", { className: "admin-card__caption", children: "Estad\u00EDsticas generales" }), _jsxs("div", { className: "admin-stats-summary", children: [_jsxs("div", { className: "admin-stat-item", children: [_jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", children: "sports_esports" }), _jsxs("div", { children: [_jsx("p", { children: "Partidas finalizadas" }), _jsx("strong", { children: stats?.total_games_finished ?? 0 })] })] }), _jsxs("div", { className: "admin-stat-item", children: [_jsx("span", { className: "material-symbols-outlined", style: { color: "var(--color-primary)" }, "aria-hidden": "true", children: "account_balance" }), _jsxs("div", { children: [_jsx("p", { children: "Ingresos Sistema" }), _jsx("strong", { children: formatCredits(stats?.total_system_revenue ?? 0) })] })] })] })] }), _jsxs("article", { className: "admin-card admin-card--activity", children: [_jsx("header", { children: _jsx("p", { className: "admin-card__title", children: "Actividad reciente" }) }), _jsxs("ul", { className: "admin-activity", children: [isLoading && (_jsxs(_Fragment, { children: [_jsx("li", { className: "admin-activity__skeleton" }), _jsx("li", { className: "admin-activity__skeleton" }), _jsx("li", { className: "admin-activity__skeleton" })] })), !isLoading && activity.length === 0 && (_jsxs("li", { className: "admin-activity__empty", children: [_jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", children: "inbox" }), _jsx("p", { children: "No hay actividad reciente" })] })), !isLoading && activity.slice(0, 10).map((item) => (_jsxs("li", { children: [_jsx("div", { className: `admin-activity__icon admin-activity__icon--${item.tone}`, children: _jsx("span", { className: "material-symbols-outlined", "aria-hidden": "true", children: item.icon }) }), _jsxs("div", { className: "admin-activity__content", children: [_jsxs("p", { children: [_jsx("strong", { children: item.title }), " ", item.description] }), _jsx("time", { children: item.time })] })] }, item.id)))] })] })] })] }));
}
